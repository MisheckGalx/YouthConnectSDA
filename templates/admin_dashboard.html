{% extends "base.html" %}

{% block title %}Admin Dashboard - Clayville SDA Church{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="admin-header">
        <h1>Admin Dashboard</h1>
        <a href="{{ url_for('admin_logout') }}" class="btn btn-secondary">Logout</a>
    </div>
    
    <div class="admin-grid">
        <!-- Add New Event -->
        <div class="admin-card">
            <h2>Add New Event</h2>
            <form method="POST" action="{{ url_for('add_event') }}">
                <div class="form-group">
                    <label>Event Title *</label>
                    <input type="text" name="title" required placeholder="e.g., Youth Fellowship Night">
                </div>
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" name="date" required>
                </div>
                <div class="form-group">
                    <label>Description *</label>
                    <textarea name="description" required placeholder="Brief description of the event..."></textarea>
                </div>
                <div class="form-group">
                    <label>Image URL</label>
                    <input type="url" name="image_url" placeholder="https://example.com/image.jpg">
                    <small style="color: var(--gray); display: block; margin-top: 0.25rem;">
                        Optional: Use Unsplash, Pexels, or your own hosted images
                    </small>
                </div>
                <button type="submit" class="btn btn-primary">Add Event</button>
            </form>
        </div>
        
        <!-- Add New Sermon -->
        <div class="admin-card">
            <h2>Add New Sermon</h2>
            <form method="POST" action="{{ url_for('add_sermon') }}">
                <div class="form-group">
                    <label>Sermon Title *</label>
                    <input type="text" name="title" required placeholder="e.g., The Power of Grace">
                </div>
                <div class="form-group">
                    <label>Preacher Name *</label>
                    <input type="text" name="preacher" required placeholder="e.g., Pastor John Smith">
                </div>
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" name="date" required>
                </div>
                <div class="form-group">
                    <label>YouTube Embed URL</label>
                    <input type="url" name="youtube_url" placeholder="https://www.youtube.com/embed/VIDEO_ID">
                    <small style="color: var(--gray); display: block; margin-top: 0.25rem;">
                        Use YouTube's embed URL format (not the regular watch URL)
                    </small>
                </div>
                <div class="form-group">
                    <label>Description *</label>
                    <textarea name="description" required placeholder="Brief description of the sermon message..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Add Sermon</button>
            </form>
        </div>
    </div>
    
    <!-- Manage Events -->
    <div class="admin-card" style="margin-top: 2rem;">
        <h2>Manage Events</h2>
        {% if events %}
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for event in events %}
                <tr>
                    <td><strong>{{ event['title'] }}</strong></td>
                    <td>{{ event['date'] }}</td>
                    <td>{{ event['description'][:50] }}...</td>
                    <td>
                        <form method="POST" action="{{ url_for('delete_event', event_id=event['id']) }}" style="display: inline;" onsubmit="return confirmDelete('event');">
                            <button type="submit" class="btn btn-danger btn-small">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: var(--gray); text-align: center; padding: 2rem;">No events yet. Add your first event above!</p>
        {% endif %}
    </div>
    
    <!-- Manage Sermons -->
    <div class="admin-card" style="margin-top: 2rem;">
        <h2>Manage Sermons</h2>
        {% if sermons %}
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Preacher</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for sermon in sermons %}
                <tr>
                    <td><strong>{{ sermon['title'] }}</strong></td>
                    <td>{{ sermon['preacher'] }}</td>
                    <td>{{ sermon['date'] }}</td>
                    <td>
                        <form method="POST" action="{{ url_for('delete_sermon', sermon_id=sermon['id']) }}" style="display: inline;" onsubmit="return confirmDelete('sermon');">
                            <button type="submit" class="btn btn-danger btn-small">Delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p style="color: var(--gray); text-align: center; padding: 2rem;">No sermons yet. Add your first sermon above!</p>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Confirm before deleting
function confirmDelete(itemType) {
    return confirm(`Are you sure you want to delete this ${itemType}? This action cannot be undone.`);
}
</script>
{% endblock %}
